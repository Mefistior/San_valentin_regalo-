<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Para Laura ❤️</title>

<style>
body{
    margin:0;
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(to bottom, #ffe6f0, #fff5f9);
    display:flex;
    flex-direction:column;
    height:100vh;
}

#layout{
    display:flex;
    height:80vh;
}

#text{
    width:50%;
    display:flex;
    flex-direction:column;
    justify-content:center;
    padding:40px;
    color:#8b0033;
    font-size:18px;
}

#tree-area{
    width:50%;
    display:flex;
    justify-content:center;
    align-items:flex-end;
}

canvas{
    display:block;
}

#counter{
    height:20vh;
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
    font-size:16px;
    color:#ad1457;
}
</style>
</head>

<body>

<div id="layout">

<div id="text">
    <h2>Para Laura ❤️</h2>
    <p>Eres la persona que llena mi mundo.</p>
    <p>Eres mi felicidad y mi paz.</p>
    <p>Eres el amor que encontré sin buscar.</p>
    <p>Y cada día contigo es un regalo maravilloso.</p>
</div>

<div id="tree-area">
    <canvas id="treeCanvas"></canvas>
</div>

</div>

<div id="counter"></div>

<script>
const canvas = document.getElementById("treeCanvas");
const ctx = canvas.getContext("2d");

function resize(){
    canvas.width = window.innerWidth/2;
    canvas.height = window.innerHeight*0.8;
}
resize();
window.addEventListener("resize", resize);

let branches=[];
let endpoints=[];
let started=false;

canvas.addEventListener("click", ()=>{
    if(!started){
        started=true;
        startTree();
    }
});

function startTree(){
    branches.push({
        x: canvas.width/2,
        y: canvas.height,
        length: 110,
        angle: -90,
        width: 16
    });
    grow();
}

function grow(){
    if(branches.length===0){
        drawFlowers();
        return;
    }

    let newBranches=[];

    branches.forEach(branch=>{
        const rad = branch.angle*Math.PI/180;
        const x2 = branch.x + branch.length*Math.cos(rad);
        const y2 = branch.y + branch.length*Math.sin(rad);

        ctx.strokeStyle="#6b3e26";
        ctx.lineWidth=branch.width;
        ctx.lineCap="round";

        ctx.beginPath();
        ctx.moveTo(branch.x,branch.y);
        ctx.lineTo(x2,y2);
        ctx.stroke();

        if(branch.width>2){
            const count=2 + Math.floor(Math.random()*2);

            for(let i=0;i<count;i++){
                newBranches.push({
                    x:x2,
                    y:y2,
                    length:branch.length*(0.75),
                    angle:branch.angle + (Math.random()*80 - 40), // MÁS ABIERTO
                    width:branch.width*0.7
                });
            }
        }else{
            endpoints.push({x:x2,y:y2});
        }
    });

    branches=newBranches;
    setTimeout(grow,150);
}

function drawHeart(x,y,size){
    ctx.fillStyle="#ff4d6d";
    ctx.beginPath();
    ctx.moveTo(x,y);
    ctx.bezierCurveTo(x-size,y-size,
                      x-size*1.6,y+size/2,
                      x,y+size);
    ctx.bezierCurveTo(x+size*1.6,y+size/2,
                      x+size,y-size,
                      x,y);
    ctx.fill();
}

function drawFlowers(){
    endpoints.forEach(point=>{
        // varias flores por punta
        for(let i=0;i<3;i++){
            const offsetX=(Math.random()*10-5);
            const offsetY=(Math.random()*10-5);
            drawHeart(point.x+offsetX,point.y+offsetY,6);
        }
    });
}

// contador
const startDate=new Date("2023-08-20");

function updateCounter(){
    const now=new Date();
    const diff=now-startDate;
    const days=Math.floor(diff/(1000*60*60*24));
    const years=Math.floor(days/365);
    const months=Math.floor((days%365)/30);
    const remainingDays=days%30;

    document.getElementById("counter").innerText=
    `Mi amor por ti comenzó el 20/08/2023 ❤️
Han pasado ${years} años, ${months} meses y ${remainingDays} días juntos`;
}
updateCounter();
setInterval(updateCounter,86400000);
</script>

</body>
</html>
