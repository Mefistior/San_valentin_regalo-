<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Para Laura ❤️</title>

<style>
body{
    margin:0;
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(to bottom, #ffe6f0, #fff5f9);
    display:flex;
    flex-direction:column;
    min-height:100vh;
    overflow-x:hidden;
}

#contenido{
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    text-align:center;
    padding:30px 20px 10px 20px;
}

h1{
    color:#c2185b;
    margin-bottom:10px;
}

p{
    color:#8b0033;
    max-width:500px;
    margin:6px auto;
    font-size:16px;
}

canvas{
    margin-top:20px;
}

#counter{
    margin-top:15px;
    font-size:15px;
    color:#ad1457;
}

@media(min-width:768px){
    #contenido{
        padding-top:50px;
    }
    p{
        font-size:18px;
    }
}
</style>
</head>

<body>

<div id="contenido">
    <h1>Para Laura ❤️</h1>

    <p>Eres la persona que llena mi mundo.</p>
    <p>Eres mi felicidad y mi paz.</p>
    <p>Eres el amor que encontré sin buscar.</p>
    <p>Y cada día contigo es un regalo maravilloso.</p>

    <canvas id="treeCanvas"></canvas>

    <div id="counter"></div>
</div>

<script>
const canvas = document.getElementById("treeCanvas");
const ctx = canvas.getContext("2d");

function resizeCanvas(){
    canvas.width = Math.min(window.innerWidth * 0.9, 500);
    canvas.height = 400;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

let branches = [];
let endpoints = [];
let started = false;

canvas.addEventListener("click", () => {
    if(!started){
        started = true;
        startTree();
    }
});

function startTree(){
    branches.push({
        x: canvas.width/2,
        y: canvas.height,
        length: 90,
        angle: -90,
        width: 14
    });
    grow();
}

function grow(){
    if(branches.length === 0){
        drawFlowers();
        return;
    }

    let newBranches = [];

    branches.forEach(branch => {

        const rad = branch.angle * Math.PI/180;
        const x2 = branch.x + branch.length * Math.cos(rad);
        const y2 = branch.y + branch.length * Math.sin(rad);

        ctx.strokeStyle = "#6b3e26";
        ctx.lineWidth = branch.width;
        ctx.lineCap = "round";

        ctx.beginPath();
        ctx.moveTo(branch.x, branch.y);
        ctx.lineTo(x2, y2);
        ctx.stroke();

        if(branch.width > 2){
            const count = Math.random() > 0.5 ? 2 : 3;

            for(let i=0;i<count;i++){
                newBranches.push({
                    x: x2,
                    y: y2,
                    length: branch.length * (0.7 + Math.random()*0.1),
                    angle: branch.angle + (Math.random()*40 - 20),
                    width: branch.width * 0.7
                });
            }
        } else {
            endpoints.push({x:x2,y:y2});
        }
    });

    branches = newBranches;
    setTimeout(grow,180);
}

function drawHeart(x,y,size){
    ctx.fillStyle="#ff4d6d";
    ctx.beginPath();
    ctx.moveTo(x,y);
    ctx.bezierCurveTo(x-size,y-size,
                      x-size*1.5,y+size/2,
                      x,y+size);
    ctx.bezierCurveTo(x+size*1.5,y+size/2,
                      x+size,y-size,
                      x,y);
    ctx.fill();
}

function drawFlowers(){
    let i=0;
    const interval = setInterval(()=>{
        if(i>=endpoints.length){
            clearInterval(interval);
            return;
        }
        drawHeart(endpoints[i].x,endpoints[i].y,6);
        i++;
    },80);
}

// Contador
const startDate = new Date("2023-08-20");
function updateCounter(){
    const now = new Date();
    const diff = now - startDate;
    const days = Math.floor(diff/(1000*60*60*24));
    const years = Math.floor(days/365);
    const months = Math.floor((days%365)/30);
    const remainingDays = days%30;

    document.getElementById("counter").innerText =
    `Mi amor por ti comenzó el 20/08/2023 ❤️
Han pasado ${years} años, ${months} meses y ${remainingDays} días juntos`;
}
updateCounter();
setInterval(updateCounter,86400000);
</script>

</body>
</html>
